# !/user/bin/bash

w=7
nm=2
f=test-data

#from
fromr=""
function from {
l=$(ls ./data)
from=0
echo select the table 
select fr in $l
do 
if [[ $fr == "" ]]
then 
echo enter valid number
else
from=$fr
break
fi
done
fromr=$from 
}
#from end





#where
wherer=0
function where {
meta=$(awk ' BEGIN{FS=","} {  
  for(i = 1; i<=NF ; i++)
    {
    print $i
    }
    } END{} ' ./meta/$fromr.meta)
wtype=-1
wno=-1
select wh in $meta
do
if [[ $wh == "" ]]
then 
echo enter valid number
else
wtype=$wh
wno=$REPLY
break
fi
done

if [[ $(echo $wtype |cut -d ":" -f 2) == "int" ]]
then 

select op in "==" "<=" ">=" "<" ">"
do

if [[ $op == "" ]]
then 
echo enter valid number
else
read -p "Please Enter condition value: " condval
if [[ $condval =~ ^[1-9]+$ ]]
then 
condition_row=$(awk ' BEGIN{FS=":"} { 
if ( $'$wno' '$op' '$condval' ){
print NR
}
} END{ } ' ./data/$fromr )
break
else echo not a number
fi
fi
done
else 
read -p "Please Enter condition value: " condval
condition_row=$(
awk -v condv="$condval" ' BEGIN{FS=":"} { 
if ( $'$wno' == condv){
print NR
}
} END{ } ' ./data/$fromr
)
fi
wherer=$condition_row
}






#delete part

from
where
echo this is the result of where : $wherer
wherer=($wherer)
del=""
for i in "${wherer[@]}"
do
del+=$i"d;"
done
sed -i "$del" ./data/$fromr














<<comment





# op='<='
# if (( 4 $op 5 )) 
# then  echo working
# fi






awk '
BEGIN{ FS =":"}
{
if($1 == '$w'){
print $0 
}
}
END{}' ./$f



comment
